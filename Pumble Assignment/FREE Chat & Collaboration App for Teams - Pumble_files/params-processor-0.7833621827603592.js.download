const PUMBLE_UTM_PARAMS_KEY="pmbl-utm-params",PUMBLE_UTM_ANALYTICS_PARAMS_KEY="pmbl-utm-analytics-params",PUMBLE_UTM_ATTRIBUTION_KEY="pmbl-utm-attribution-params",storeUtmParams=()=>{try{var t=new URLSearchParams(window.location.search);const e=[];t.forEach((t,a)=>{!a.startsWith("utm_")&&"gclid"!==a||e.push({key:a,value:t})}),e.length&&localStorage.setItem(PUMBLE_UTM_PARAMS_KEY,JSON.stringify(e))}catch(t){console.log("issue storing utm params",t)}},findUtmParamsForAppStore=(a,t)=>{try{var e=t||[];for(let t=0;t<e.length;t++)if(e[t].key===a)return e[t].value;return""}catch(t){console.log("issue finding utm params",t)}},storeUtmCpcParams=()=>{try{var t,a,e,r,m;localStorage.getItem(PUMBLE_UTM_ANALYTICS_PARAMS_KEY)||(a=(t=new URLSearchParams(window.location.search)).get("utm_medium"),e=t.get("utm_source"),r=t.get("utm_campaign"),m=t.get("utm_term"),a&&e&&localStorage.setItem(PUMBLE_UTM_ANALYTICS_PARAMS_KEY,JSON.stringify({utmMedium:a,utmSource:e,utmCampaign:r,utmTerm:m})),localStorage.getItem(PUMBLE_UTM_ATTRIBUTION_KEY))||localStorage.setItem(PUMBLE_UTM_ATTRIBUTION_KEY,a&&e&&("cpc"===a||"paid_social"===a)?"fc":"oc")}catch(t){console.log("issue storing cpc utm params",t)}},attachUtmParams=()=>{try{var t=localStorage.getItem(PUMBLE_UTM_PARAMS_KEY),a=t?JSON.parse(t):[];if(a.length){var e=document.getElementsByTagName("a");if(e&&e.length)for(let t=0;t<e.length;t++){var r,m,o,s,c,i=e[t];i.href.startsWith("https://play.google.com/store/apps/details?id=com.pumble")&&(r=a.map(t=>t.key+"="+t.value).join("&"),i.href+="&referrer="+encodeURIComponent(r)),i.href.startsWith("https://apps.apple.com/us/app/pumble/id1536136725")&&(m=findUtmParamsForAppStore("utm_source",a),o=findUtmParamsForAppStore("utm_medium",a),s=findUtmParamsForAppStore("utm_campaign",a),c=findUtmParamsForAppStore("utm_content",a),i.href="https://click.google-analytics.com/redirect?tid=262760258&url=https%3A%2F%2Fitunes.apple.com%2Fus%2Fapp%2Fpumble%2Fid1536136725&aid=com.pumble.app&idfa={idfa}&cs="+m+"&cm="+o+"&cn="+s+"&cc="+c+"&ck=pumble&anid=admob&hash=md5")}}}catch(t){console.log("issue attaching app store links",t)}};window.addEventListener("load",()=>{storeUtmParams(),storeUtmCpcParams(),attachUtmParams()});